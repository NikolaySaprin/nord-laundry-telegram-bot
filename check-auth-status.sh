#!/bin/bash

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ WhatsApp..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ –±–æ—Ç
if pgrep -f "node bot-runner" > /dev/null; then
    echo "‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω"
    BOT_PID=$(pgrep -f "node bot-runner")
    echo "üìã PID –ø—Ä–æ—Ü–µ—Å—Å–∞: $BOT_PID"
else
    echo "‚ùå –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω"
    echo "üí° –ó–∞–ø—É—Å—Ç–∏—Ç–µ: npm start"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞–ø–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
AUTH_DIR=".wwebjs_auth"
if [ -d "$AUTH_DIR" ]; then
    echo "‚úÖ –ü–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏
    SIZE=$(du -sh "$AUTH_DIR" 2>/dev/null | awk '{print $1}')
    echo "üìä –†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: $SIZE"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    if [ "$(ls -A "$AUTH_DIR" 2>/dev/null)" ]; then
        echo "‚úÖ –ü–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø—É—Å—Ç–∞—è"
        echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ:"
        ls -la "$AUTH_DIR"
    else
        echo "‚ö†Ô∏è –ü–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—É—Å—Ç–∞—è - –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
    fi
else
    echo "‚ùå –ü–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
fi

echo ""
echo "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:"
echo "1. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—É—Å—Ç–∞—è –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:"
echo "   - –û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR –∫–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω –±–æ—Ç"
echo "   - –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Å—Å—ã–ª–∫—É —Å QR –∫–æ–¥–æ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ"
echo ""
echo "2. –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ –ø—É—Å—Ç–∞—è:"
echo "   - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω–∞"
echo "   - –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"
echo ""
echo "3. –î–ª—è –æ—á–∏—Å—Ç–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:"
echo "   - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (Ctrl+C)"
echo "   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ: npm run clear-session"
echo "   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ: npm start"
