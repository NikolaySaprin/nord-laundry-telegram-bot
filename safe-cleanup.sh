#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะฑะตะทะพะฟะฐัะฝะพะน ะพัะธััะบะธ ะฟัะพะตะบัะฐ ะพั ะฝะตะฝัะถะฝัั ัะฐะนะปะพะฒ
# ะฃะดะฐะปัะตั ัะพะปัะบะพ ัะฐะนะปั, ะบะพัะพััะต ะฝะต ะฝัะถะฝั ะฒ ะฟัะพะดะฐะบัะตะฝะต

set -e

echo "๐งน ะัะธััะบะฐ ะฟัะพะตะบัะฐ ะพั ะฝะตะฝัะถะฝัั ัะฐะนะปะพะฒ..."
echo ""

# ะคัะฝะบัะธั ะดะปั ะฑะตะทะพะฟะฐัะฝะพะณะพ ัะดะฐะปะตะฝะธั ัะฐะนะปะฐ
safe_remove() {
    local file=$1
    if [ -f "$file" ]; then
        echo "๐๏ธ  ะฃะดะฐะปัะตะผ: $file"
        rm "$file"
    else
        echo "โญ๏ธ  ะคะฐะนะป ะฝะต ะฝะฐะนะดะตะฝ (ะฟัะพะฟััะบะฐะตะผ): $file"
    fi
}

# ะฃะดะฐะปัะตะผ ัะบัะธะฟัั ะดะปั ัะฐะทัะฐะฑะพัะบะธ
echo "๐ ะฃะดะฐะปัะตะผ ัะบัะธะฟัั ะดะปั ัะฐะทัะฐะฑะพัะบะธ..."
safe_remove "cleanup-git.sh"
safe_remove "cleanup-project.sh"
safe_remove "create-minimal-version.sh"
safe_remove "auto-auth-recovery.sh"
safe_remove "setup-auth-recovery.sh"
safe_remove "whatsapp-auth-recovery.service"

# ะฃะดะฐะปัะตะผ ะบะพะฝัะธะณััะฐัะธะพะฝะฝัะต ัะฐะนะปั ะดะปั ัะฐะทัะฐะฑะพัะบะธ
echo ""
echo "โ๏ธ  ะฃะดะฐะปัะตะผ ะบะพะฝัะธะณััะฐัะธะพะฝะฝัะต ัะฐะนะปั ะดะปั ัะฐะทัะฐะฑะพัะบะธ..."
safe_remove ".gitignore.production"
safe_remove "package.production.json"

# ะฃะดะฐะปัะตะผ ััะฐััะต ะฐััะธะฒั ะฐะฒัะพัะธะทะฐัะธะธ (ะพััะฐะฒะปัะตะผ ัะพะปัะบะพ latest)
echo ""
echo "๐ฆ ะฃะดะฐะปัะตะผ ััะฐััะต ะฐััะธะฒั ะฐะฒัะพัะธะทะฐัะธะธ..."
find . -maxdepth 1 -name "whatsapp_auth_*.tar.gz" -not -name "whatsapp_auth_latest.tar.gz" -type f -delete 2>/dev/null || true

# ะฃะดะฐะปัะตะผ ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั
echo ""
echo "๐งน ะฃะดะฐะปัะตะผ ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั..."
find . -maxdepth 1 -name "*.tmp" -type f -delete 2>/dev/null || true
find . -maxdepth 1 -name "*.temp" -type f -delete 2>/dev/null || true
find . -maxdepth 1 -name ".DS_Store" -type f -delete 2>/dev/null || true

echo ""
echo "โ ะัะธััะบะฐ ะทะฐะฒะตััะตะฝะฐ!"
echo ""
echo "๐ ะััะฐะฒัะธะตัั ัะฐะนะปั ะฟัะพะตะบัะฐ:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
ls -lh | grep -v "^d" | grep -v "node_modules" | tail -n +2 || true
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "๐ก ะะตะบะพะผะตะฝะดะฐัะธะธ:"
echo "   1. ะัะพะฒะตัััะต, ััะพ ะฒัะต ะฝะตะพะฑัะพะดะธะผัะต ัะฐะนะปั ะพััะฐะปะธัั"
echo "   2. ะกะบะพะผะฟะธะปะธััะนัะต ะฟัะพะตะบั: npm run build"
echo "   3. ะัะพัะตััะธััะนัะต ัะฐะฑะพัั ะฑะพัะฐ: npm start"
echo "   4. ะกะพะทะดะฐะนัะต ะบะพะผะผะธั: git add . && git commit -m 'Cleanup: remove development files'"
echo ""
echo "๐ ะัะพะตะบั ะณะพัะพะฒ ะบ ัะฐะทะฒะตัััะฒะฐะฝะธั ะฝะฐ VPS!"
